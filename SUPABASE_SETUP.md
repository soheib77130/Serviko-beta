# Configuration Supabase — Serviko

Ce guide prépare une authentification fonctionnelle pour **clients** et **indépendants**.

## 1) Variables déjà configurées
Les pages HTML utilisent :
- `SUPABASE_URL = https://skfqoyyoahuaffshimnc.supabase.co`
- `SUPABASE_ANON_KEY = sb_publishable_yxLCOU94zhGck9yvGYch5Q_ePCPd9Yq`

## 2) Créer les tables
Exécutez le SQL ci-dessous dans l'éditeur SQL Supabase.

```sql
create table if not exists public.clients (
  id bigint generated by default as identity primary key,
  user_id uuid not null unique,
  firstname text,
  lastname text,
  email text,
  company text,
  created_at timestamptz default now()
);

create table if not exists public.independants (
  id bigint generated by default as identity primary key,
  user_id uuid not null unique,
  firstname text,
  lastname text,
  email text,
  phone text,
  city text,
  status text,
  portfolio text,
  siret text,
  daily_rate numeric,
  experience text,
  skills text,
  created_at timestamptz default now()
);
```

## 3) Activer le RLS + Policies
```sql
alter table public.clients enable row level security;
alter table public.independants enable row level security;

create policy "clients_insert_own" on public.clients
  for insert with check (auth.uid() = user_id);

create policy "clients_select_own" on public.clients
  for select using (auth.uid() = user_id);

create policy "clients_update_own" on public.clients
  for update using (auth.uid() = user_id)
  with check (auth.uid() = user_id);

create policy "indep_insert_own" on public.independants
  for insert with check (auth.uid() = user_id);

create policy "indep_select_own" on public.independants
  for select using (auth.uid() = user_id);

create policy "indep_update_own" on public.independants
  for update using (auth.uid() = user_id)
  with check (auth.uid() = user_id);
```

## 4) Config Auth (obligatoire)
- **Auth → URL Configuration**
  - Site URL: `http://localhost:8000`
  - Redirect URLs: `http://localhost:8000/*`

## 5) Démarrage local
```bash
python -m http.server 8000
```
Puis ouvrez :
- `http://localhost:8000/signup.html`
- `http://localhost:8000/indep-signup.html`

## 6) Vérifications rapides
- Une inscription crée un utilisateur Supabase Auth.
- Une ligne est insérée dans `clients` ou `independants`.
- Les dashboards récupèrent les données via `auth.uid()`.
